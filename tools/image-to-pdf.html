<!doctype html><html lang="en"><head><meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>Image to PDF</title>
<link rel='stylesheet' href='../style.css'><style>body{margin:0;padding:18px;font-family:Inter,Arial;color:#0b1220}.note{color:#334155;margin-top:8px}</style></head><body>
<div class='container'><h2>Image â†’ PDF</h2><p class='small'>Select images to convert to an A4 PDF.</p><input id='files' type='file' accept='image/*' multiple style='margin-top:12px'><div style='margin-top:12px'><button class='btn' id='go'>Convert to PDF</button></div><p class='note'>Large images may take time.</p></div>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js'></script>
<script>
try{parent.postMessage({type:'activate', href:'tools/image-to-pdf.html'}, location.origin);}catch(e){}
async function fileToDataURL(file){return new Promise((res,rej)=>{const r=new FileReader();r.onload=()=>res(r.result);r.onerror=rej;r.readAsDataURL(file);});}
document.getElementById('go').addEventListener('click', async ()=>{
  const { jsPDF } = window.jspdf;
  const files = document.getElementById('files').files;
  if(!files || files.length===0){ alert('Please select images first'); return; }
  const pdf = new jsPDF({ unit:'pt', format:'a4' });
  for(let i=0;i<files.length;i++){
    const data = await fileToDataURL(files[i]);
    const img = new Image(); img.src = data; await new Promise(r=>img.onload=r);
    const pageW = pdf.internal.pageSize.getWidth(); const pageH = pdf.internal.pageSize.getHeight();
    let iw = img.width, ih = img.height; const ratio = Math.min(pageW/iw, pageH/ih); const w = iw*ratio; const h = ih*ratio; const x = (pageW-w)/2; const y = (pageH-h)/2;
    if(i>0) pdf.addPage();
    const type = data.indexOf('image/png')!==-1 ? 'PNG' : 'JPEG';
    pdf.addImage(data, type, x, y, w, h);
  }
  pdf.save('ToolMancer_images.pdf');
});
</script></body></html>